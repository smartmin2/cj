<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <title>ip조회</title>
    <meta http-equiv="Content-Script-Type" content="text/javascript" />
    <meta http-equiv="Content-Style-Type" content="text/css" />
    <meta http-equiv="X-UA-Compatible" content="IE=edge" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <link rel="stylesheet" href="../../../css/lib/bootstrap.min.css" />
    <link rel="stylesheet" href="../../../css/lib/jquery-ui.css" />
    <link rel="stylesheet" href="../../../AUIGrid/AUIGrid_modern_style.css" />
    <link rel="stylesheet" href="../../../css/core/style.css" />
    <link rel="stylesheet" href="../../../css/core/main.css" />
    <link rel="stylesheet" href="../../../css/core/main_extra.css" />
    <link rel="stylesheet" href="../../../css/core/style_sub.css" />

    <script src="../../../js/lib/jquery.js"></script>
    <script src="../../../js/lib/vue.js"></script>
    <script src="../../../js/lib/bootstrap.js"></script>
    <script src="../../../AUIGrid/AUIGrid.js"></script>
    <script src="../../../AUIGrid/AUIGridLicense.js"></script>
    <script src="../../../js/all.min.js"></script>
    
  </head>
  <body>
    <div class="container-fluid">
      <div id="app" class="pt-3">
        <!-- 탭 영역 -->
        <div role="navigation" class="card-box d-flex nav-wrap justify-content-between align-items-center">
          <ul class="nav nav-tabs step-nav" role="tablist" id="myTab">
            <li role="presentation" class="active">
              <a href="#mps" aria-controls="mps" role="tab" data-toggle="tab"
                ><span class="number">1</span>
                <div>경영계획기준 시뮬레이션</div>
              </a>
            </li>
            <li role="presentation">
              <a href="#channel" aria-controls="channel" role="tab" data-toggle="tab">
                <span class="number">2</span>
                <div>채널기준 월별 시청량조회</div></a
              >
            </li>
            <li role="presentation">
              <a href="#messages" aria-controls="messages" role="tab" data-toggle="tab"
                ><span class="number">3</span>
                <div>경쟁사 비교 시뮬레이션</div></a
              >
            </li>
            <li role="presentation">
              <a href="#settings" aria-controls="settings" role="tab" data-toggle="tab">
                <span class="number">4</span>
                <div>경쟁사 비교 월별 시청량 조회</div></a
              >
            </li>
            <li role="presentation">
              <a href="#rank" aria-controls="rank" role="tab" data-toggle="tab"
                ><span class="number">5</span>
                <div>채널순위</div></a
              >
            </li>
          </ul>
          <div class="d-flex cj-btn-group align-items-end">
            <button type="button" class="btn-dark btn-prev">이전</button>
            <button type="button" class="btn-dark btn-next">다음</button>
          </div>
        </div>
        <div class="tab-content">
          <div role="tabpanel" class="tab-pane active" id="mps">
            <div class="card card-box mr-0 mt-4" id="app1">
              <div class="card-body">
                <!-- grid 영역 -->
                <div class="mt-4">
                  <div id="bsnPlanGrid" style="height: 90px"></div>
                </div>
              </div>
            </div>
            <!-- 검색조건 영역 -->
            <div class="card card-box mr-0 mt-4" id="app2">
              <div class="card-body">
                <div class="d-flex justify-content-between">
                  <div class="d-flex justify-content-start align-items-end">
                    <label for="">광고손실율</label>
                    <input type="number" class="form-control" name="" id="">
                  </div>

                  <div class="d-flex cj-btn-group align-items-end">
                    <button type="button" class="btn-dark btn-black"><i class="fa-solid fa-plus"></i>추가</button>
                    <button type="button" class="btn-dark btn-black">엑셀저장</button>
                    <button type="button" class="btn-dark btn-black" @click.end="createScenario">제작비 시청률</button>
                    <button type="button" class="btn-dark btn-black">제작비 상세</button>
                    <button type="button" class="btn-dark btn-gray">닫기</button>
                  </div>
                </div>
                <!-- grid 영역 -->
                <div class="mt-4">
                  <div id="bsnDetailGrid" style="min-height: 400px"></div>
                </div>

                <!-- 시나리오 modal-->
                <scenario-summary-modal ref="refScenarioSummary" />
              </div>
            </div>
          </div>
          <div role="tabpanel" class="tab-pane active" id="channel">
            <div class="card card-box mr-0 mt-4" id="app3">
              <div class="card-body">
                <!-- grid 영역 -->
                <div class="mt-4">
                  <div id="channelBaseGrid" style="height: 90px"></div>
                </div>
              </div>
            </div>
            <!-- 검색조건 영역 -->
            <div class="card card-box mr-0 mt-4" id="app4">
              <div class="card-body">
                <div class="d-flex justify-content-between">
                  <div class="d-flex justify-content-start align-items-end">

                  </div>

                  <div class="d-flex cj-btn-group align-items-end">
                    <button type="button" class="btn-dark btn-black">엑셀저장</button>
                  </div>
                </div>
                <!-- grid 영역 -->
                <div class="mt-4">
                  <div id="cbDetailGrid" style="min-height: 400px;" ></div>
                </div>

                <!-- 시나리오 modal-->
                <scenario-summary-modal ref="refScenarioSummary" />
              </div>
            </div>
          </div>
          <div role="tabpanel" class="tab-pane" id="messages">.3..</div>
          <div role="tabpanel" class="tab-pane" id="settings">.4..</div>
          <div role="tabpanel" class="tab-pane" id="rank">.5..</div>
        </div>
      </div>
    </div>

    <script>
      // tab1 start
      let bsnPlanGrid = "";
      let app1 = {
        el: "#app1",
        watch: {
          gridData: function () {
            AUIGrid.setGridData(bsnPlanGrid, this.gridData);
          },
        },
        mounted() {
          bsnPlanGrid = AUIGrid.destroy("#bsnPlanGrid");
          bsnPlanGrid = AUIGrid.create("#bsnPlanGrid", this.gridLayout, this.gridProps);

          // 페이지 진입 시 기준년도 산출
          this.searchCommand.baseYear = new Date().getFullYear();
          // 기준년도 항목정의(과거:3년, 향후:5년)
          for (let idx = this.searchCommand.baseYear - 2; idx < this.searchCommand.baseYear + 5; idx += 1) {
            this.selectOptionItems.baseYear.push({ value: `${idx}`, text: `${idx}년` });
          }

          this.selectOptionItems.status.push({ value: "I", text: "진행중" });
          this.selectOptionItems.status.push({ value: "C", text: "확정" });

          this.search();
        },
        data: () => ({
          selectOptionItems: {
            baseYear: [{ value: "", text: "기준년도" }],
            genre: [{ value: "", text: "장르" }],
            status: [{ value: "", text: "채널그룹명" }],
          },
          searchCommand: {
            scenarioName: null,
            baseYear: "",
            genre: "",
            status: "",
          },
          gridData: [],
          gridLayout: [
            {
              dataField: "baseYear",
              headerText: "기준년도",
              width: "7%",
              editRenderer: {
                type: "DropDownListRenderer",
                list: ["2020년", "2021년", "2022년"],
              },
            },
            {
              dataField: "rating",
              headerText: "시청률",
              width: "7%",
              editRenderer: {
                type: "DropDownListRenderer",
                list: ["수도권"],
              },
            },
            {
              dataField: "scenarioName",
              headerText: "시나리오명",
              width: "40%",
              editRenderer: {
                type: "InputEditRenderer",
                showEditorBtnOver: true, // 마우스 오버 시 에디터버턴 보이기
                inputMode: "text",
              },
            },
            {
              dataField: "step",
              headerText: "단계",
              editRenderer: {
                type: "DropDownListRenderer",
                list: ["진행중", "확정"],
              },
            },
            {
              headerText: "재방비율(년/요일)",
              renderer: {
                type: "TemplateRenderer",
              },
              labelFunction: function (rowIndex, columnIndex, value, headerText, item) {
                let btnList = [];
                let setBtnClass = function () {
                  return btnList.push(`<button class="btn btn-dark btn-black" onClick="app.edit(${item["id"]})">상세 등록</button>`);
                };
                if (item["status"] == "I") {
                  btnList.push(`<button class="btn btn-dark btn-black" onClick="app.edit(${item["id"]})">상세 등록</button>`);
                }
                return `<div class="d-flex flex-fill justify-content-center">${btnList.join("")}</div>`;
              },
            },
            {
              headerText: "등록정보",
              width: "15%",
              renderer: {
                type: "TemplateRenderer",
              },
              labelFunction: function (rowIndex, columnIndex, value, headerText, item) {
                return `${item["departName"]} | ${item["writer"]} | ${item["createAt"]}`; //item.bdp_mod_id + "|" + item.bdp_mod_dtm;
              },
            },
            {
              headerText: "관리",
              renderer: {
                type: "TemplateRenderer",
              },
              labelFunction: function (rowIndex, columnIndex, value, headerText, item) {
                let btnList = [];
                let setBtnClass = function () {
                  return btnList.push(`<button class="btn btn-dark btn-black" onClick="app.edit(${item["id"]})">수정</button>`);
                };
                if (item["status"] == "I") {
                  btnList.push(`<button class="btn btn-dark btn-black" onClick="app.edit(${item["id"]})">수정</button>`);
                }
                return `<div class="d-flex flex-fill justify-content-center">${btnList.join("")}</div>`;
              },
            },
          ],
          gridProps: {
            enableFilter: false,
            enableSorting: false,
            headerHeight: 60,
            headerHeights: [30, 30],
            rowHeight: 50,
            editingOnKeyDown: false,
            autoGridHeight: false,
            autoGridWidth: false,
            ignoreColumnMinWidth: true,
            softRemoveRowMode: false,
            // 행 번호 컬럼 활성화 속성입니다.
            showRowNumColumn: false,
            /*추가 옵션*/
            showStateColumn: false,
            editable: true,
            noDataMessage: "엑셀데이터를 붙여넣거나 행추가를 통해 데이터를 입력하세요.",
          },
        }),
        methods: {
          search: function () {
            console.log("search", this.searchCommand);
            this.setTestData();
          },
          createScenario: function () {
            this.$refs["refScenarioSummary"].draw();
          },
          edit: function (id) {
            console.log("준비중 edit", id);
          },
          version: function (id) {
            console.log("준비중 version", id);
          },
          copy: function (id) {
            console.log("준비중 copy", id);
          },
          remove: function (id) {
            console.log("준비중 remove", id);
          },
          done: function (id) {
            console.log("준비중 done", id);
          },
          setTestData: function () {
            this.gridData = [];
            this.gridData.push({
              writer: "홍길동",
              departName: "부서명",
              createAt: "2022.10.12",
              listNum: "1",
              baseYear: "2023",
              rating: "수도권",
              scenarioName: "2023년 경영기반 시뮬레이션 1차",
              step: "확정",
              status: "I",
              id: 2,
              version: 0,
            });
          },
        },
      };

      $(function () {
        new Vue(app1);
        Vue.nextTick(function () {
          $(window).resize(function () {
            AUIGrid.resize("#bsnPlanGrid");
          });
        });
        // Vue.component();
      });

      let bsnDetailGrid = "";
      let app2 = {
        el: "#app2",
        watch: {
          gridData: function () {
            AUIGrid.setGridData(bsnDetailGrid, this.gridData);
          },
        },
        mounted() {
          bsnDetailGrid = AUIGrid.destroy("#bsnDetailGrid");
          bsnDetailGrid = AUIGrid.create("#bsnDetailGrid", this.gridLayout, this.gridProps);

          // 페이지 진입 시 기준년도 산출
          this.searchCommand.baseYear = new Date().getFullYear();
          // 기준년도 항목정의(과거:3년, 향후:5년)
          for (let idx = this.searchCommand.baseYear - 2; idx < this.searchCommand.baseYear + 5; idx += 1) {
            this.selectOptionItems.baseYear.push({ value: `${idx}`, text: `${idx}년` });
          }

          this.selectOptionItems.status.push({ value: "I", text: "진행중" });
          this.selectOptionItems.status.push({ value: "C", text: "확정" });

          this.search();
        },
        data: () => ({
          selectOptionItems: {
            baseYear: [{ value: "", text: "기준년도" }],
            genre: [{ value: "", text: "장르" }],
            status: [{ value: "", text: "채널그룹명" }],
          },
          searchCommand: {
            scenarioName: null,
            baseYear: "",
            genre: "",
            status: "",
          },
          gridData: [],
          gridLayout: [
            {
              dataField: "channel",
              headerText: "채널",
              width: "5%",
              editRenderer: {
                type: "InputEditRenderer",
                showEditorBtnOver: true, // 마우스 오버 시 에디터버턴 보이기
                inputMode: "text",
              },
            },
            {
              dataField: "genre",
              headerText: "장르",
              width: "5%",
              editRenderer: {
                type: "InputEditRenderer",
                showEditorBtnOver: true, // 마우스 오버 시 에디터버턴 보이기
                inputMode: "text",
              },
            },
            {
              dataField: "blockGrp",
              headerText: "블록그룹",
              width: "5%",
              editRenderer: {
                type: "InputEditRenderer",
                showEditorBtnOver: true, // 마우스 오버 시 에디터버턴 보이기
                inputMode: "text",
              },
            },
            {
              dataField: "prTime",
              headerText: "방영기간",
              editRenderer: {
                type: "InputEditRenderer",
                showEditorBtnOver: true, // 마우스 오버 시 에디터버턴 보이기
                inputMode: "text",
              },
            },
            {
              dataField: "program",
              headerText: "프로그램",
              editRenderer: {
                type: "InputEditRenderer",
                showEditorBtnOver: true, // 마우스 오버 시 에디터버턴 보이기
                inputMode: "text",
              },
            },
            {
              dataField: "episode",
              headerText: "회차",
              width: "5%",
              editRenderer: {
                type: "InputEditRenderer",
                showEditorBtnOver: true, // 마우스 오버 시 에디터버턴 보이기
                inputMode: "text",
              },
            },
            {
              dataField: "prodCf",
              headerText: "제작구분",
              width: "5%",
              editRenderer: {
                type: "InputEditRenderer",
                showEditorBtnOver: true, // 마우스 오버 시 에디터버턴 보이기
                inputMode: "text",
              },
            },
            {
              dataField: "orgBlock",
              headerText: "편성블록",
              editRenderer: {
                type: "InputEditRenderer",
                showEditorBtnOver: true, // 마우스 오버 시 에디터버턴 보이기
                inputMode: "text",
              },
            },
            {
              dataField: "week",
              headerText: "주중/주말",
              width: "5%",
              editRenderer: {
                type: "InputEditRenderer",
                showEditorBtnOver: true, // 마우스 오버 시 에디터버턴 보이기
                inputMode: "text",
              },
            },
            {
              dataField: "prodCost",
              headerText: "제작비",
              width: "5%",
              editRenderer: {
                type: "InputEditRenderer",
                showEditorBtnOver: true, // 마우스 오버 시 에디터버턴 보이기
                inputMode: "text",
              },
            },
            {
              dataField: "exRating",
              headerText: "예상 시청률",
              width: "5%",
              editRenderer: {
                type: "InputEditRenderer",
                showEditorBtnOver: true, // 마우스 오버 시 에디터버턴 보이기
                inputMode: "text",
              },
            },
            {
              dataField: "performance",
              headerText: "실적",
              width: "5%",
              editRenderer: {
                type: "InputEditRenderer",
                showEditorBtnOver: true, // 마우스 오버 시 에디터버턴 보이기
                inputMode: "text",
              },
            },
            {
              dataField: "event",
              headerText: "이벤트",
              width: "5%",
              editRenderer: {
                type: "InputEditRenderer",
                showEditorBtnOver: true, // 마우스 오버 시 에디터버턴 보이기
                inputMode: "text",
              },
            },
            {
              headerText: "관리",
              renderer: {
                type: "TemplateRenderer",
              },
              labelFunction: function (rowIndex, columnIndex, value, headerText, item) {
                let btnList = [];
                let setBtnClass = function () {
                  return btnList.length > 0 ? "ml-1" : "";
                };
                // let plClass = ${btnList.length > 0 ? 'pl-1':''};
                // I : 진행중
                if (item["status"] == "I") {
                  btnList.push(`<button class="btn btn-dark btn-black" onClick="app.edit(${item["id"]})">수정</button>`);

                  // 상위 ID가 있는 경우 특정 시나리오의 하위버전
                  if ((item["version"] || 0) < 1) {
                    btnList.push(`<button class="btn btn-dark btn-black ${setBtnClass()}" onClick="app.version(${item["id"]})">버전추가</button>`);
                  }
                  btnList.push(`<button class="btn btn-dark btn-black ${setBtnClass()}" onClick="app.copy(${item["id"]})">복사</button>`);
                  btnList.push(`<button class="btn btn-danger btn-red ${setBtnClass()}" onClick="app.remove(${item["id"]})">삭제</button>`);
                  btnList.push(`<button class="btn btn-success ${setBtnClass()}" onClick="app.done(${item["id"]})">확정</button>`);
                } else {
                  if ((item["version"] || 0) < 1) {
                    btnList.push(`<button class="btn btn-dark btn-black ${setBtnClass()}" onClick="app.version(${item["id"]})">버전추가</button>`);
                  }
                  btnList.push(`<button class="btn btn-dark btn-black ${setBtnClass()}" onClick="app.copy(${item["id"]})">복사</button>`);
                }
                return `<div class="d-flex flex-fill justify-content-start">${btnList.join("")}</div>`;
              },
            },
          ],
          gridProps: {
            enableFilter: false,
            enableSorting: false,
            headerHeight: 60,
            headerHeights: [30, 30],
            rowHeight: 50,
            editingOnKeyDown: false,
            autoGridHeight: false,
            autoGridWidth: false,
            ignoreColumnMinWidth: true,
            softRemoveRowMode: false,
            // 행 번호 컬럼 활성화 속성입니다.
            showRowNumColumn: false,
            /*추가 옵션*/
            showStateColumn: false,
            editable: true,
            noDataMessage: "엑셀데이터를 붙여넣거나 행추가를 통해 데이터를 입력하세요.",
          },
        }),
        methods: {
          search: function () {
            console.log("search", this.searchCommand);
            this.setTestData();
          },
          createScenario: function () {
            this.$refs["refScenarioSummary"].draw();
          },
          edit: function (id) {
            console.log("준비중 edit", id);
          },
          version: function (id) {
            console.log("준비중 version", id);
          },
          copy: function (id) {
            console.log("준비중 copy", id);
          },
          remove: function (id) {
            console.log("준비중 remove", id);
          },
          done: function (id) {
            console.log("준비중 done", id);
          },
          setTestData: function () {
            this.gridData = [];
            this.gridData.push({
              channel: "tvN",
              genre: "드라마",
              blockGrp: "그룹01",
              prTime: "2023-03-01 ~ 2023-04-30",
              program: "월화드라마아이유출연",
              episode: "16",
              prodCf: "SD",
              orgBlock: "월화프라임시간대외",
              week: "주중",
              prodCost: "10",
              exRating: "2.883",
              performance: "0",
              event: "4",
              id: 2,
              version: 0,
            });
            this.gridData.push({
              channel: "tvN",
              genre: "드라마",
              blockGrp: "그룹01",
              prTime: "2023-03-01 ~ 2023-04-30",
              program: "월화드라마아이유출연",
              episode: "16",
              prodCf: "SD",
              orgBlock: "월화프라임시간대외",
              week: "주중",
              prodCost: "10",
              exRating: "2.883",
              performance: "0",
              event: "4",
              id: 2,
              version: 0,
            });
            this.gridData.push({
              channel: "tvN",
              genre: "드라마",
              blockGrp: "그룹01",
              prTime: "2023-03-01 ~ 2023-04-30",
              program: "월화드라마아이유출연",
              episode: "16",
              prodCf: "SD",
              orgBlock: "월화프라임시간대외",
              week: "주중",
              prodCost: "10",
              exRating: "2.883",
              performance: "0",
              event: "4",
              id: 2,
              version: 0,
            });
            this.gridData.push({
              channel: "tvN",
              genre: "드라마",
              blockGrp: "그룹01",
              prTime: "2023-03-01 ~ 2023-04-30",
              program: "월화드라마아이유출연",
              episode: "16",
              prodCf: "SD",
              orgBlock: "월화프라임시간대외",
              week: "주중",
              prodCost: "10",
              exRating: "2.883",
              performance: "0",
              event: "4",
              id: 2,
              version: 0,
            });
          },
        },
      };

      $(function () {
        new Vue(app2);
        Vue.nextTick(function () {
          $(window).resize(function () {
            AUIGrid.resize("#bsnDetailGrid");
          });
        });
        // Vue.component();
      });
      // tab1 end

      $(function () {
        $("#myTab a:first").tab("show");
      });

      // modal start
      Vue.component('scenario-summary-modal', {
    template: `
        <div>
            <div class="modal in" tabindex="-1" id="scenarioSummaryModal" role="dialog" data-backdrop="static" data-keyboard="false" aria-hidden="true" >
                <div class="modal-dialog modal-lg" role="document">
                    <div class="modal-content">
                        <div class="modal-header">
                            <h5 class="modal-title">제작비기준 시청률</h5>
                            
                            <button type="button" class="close" data-dismiss="modal" aria-label="Close">
                                <span aria-hidden="true">×</span>
                            </button>
                        </div>
        
                        <div class="modal-body">
                            <div id="scenarioSummaryGrid"></div>
                        </div>

                        <div class="modal-footer cj-btn-group justify-content-center">
                            <button type="button" class="btn-dark btn-black">적용</button>
                            <button type="button" class="btn-dark btn-gray">닫기</button>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    `,
    mounted(){
        $("#scenarioSummaryModal").on('show.bs.modal', function(){
            AUIGrid.resize("#scenarioSummaryGrid");
        });

        this.createGrid();
        this.search();
    },watch : {
        gridData : function(){
            AUIGrid.setGridData("#scenarioSummaryGrid", this.gridData);
        }
    },
    data: ()=>({
        gridData : [],
        gridLayout : [
        {
              dataField: "baseYear",
              headerText: "기준년도",
              width: "8%",
              editRenderer: {
                type: "DropDownListRenderer",
                list: ["2020년", "2021년", "2022년"],
              },
            },
            {
              dataField: "fromDate",
              headerText: "FROM",
              width: "14%",
              editRenderer: {
                type: "BTCalendarRenderer",
                onlyCalendar: true,
                // bootstrap-datepicker 속성을 여기에 설정하십시오.
                // API : https://bootstrap-datepicker.readthedocs.io/en/latest/options.html
                btOpts: {
                  language: "ko",
                }, // end of btOpts
              },
            },
            {
              dataField: "toDate",
              headerText: "TO",
              width: "14%",
              editRenderer: {
                type: "BTCalendarRenderer",
                onlyCalendar: true,
                // bootstrap-datepicker 속성을 여기에 설정하십시오.
                // API : https://bootstrap-datepicker.readthedocs.io/en/latest/options.html
                btOpts: {
                  language: "ko",
                }, // end of btOpts
              },
            },
            {
              dataField: "genre",
              headerText: "장르",
              editRenderer: {
                type: "DropDownListRenderer",
                list: ["드라마", "예능"],
              },
            },
            {
              dataField: "division",
              headerText: "구분",
              editRenderer: {
                type: "DropDownListRenderer",
                list: ["SD", "수급", "자체"],
              },
            },
            {
              dataField: "prdCost",
              headerText: "제작비",
              width: "10%",
              editRenderer: {
                type: "InputEditRenderer",
                showEditorBtnOver: true, // 마우스 오버 시 에디터버턴 보이기
                inputMode: "text",
              },
            },
            {
              dataField: "area",
              headerText: "수도권",
              headerHeights: [30, 30],

              children: [
                {
                  dataField: "weekday",
                  headerText: "평일",
                  width: 120,
                  editRenderer: {
                    type: "InputEditRenderer",
                    showEditorBtnOver: true, // 마우스 오버 시 에디터버턴 보이기
                    inputMode: "text",
                  },
                },
                {
                  dataField: "weekend",
                  headerText: "주말",
                  width: 120,
                  editRenderer: {
                    type: "InputEditRenderer",
                    showEditorBtnOver: true, // 마우스 오버 시 에디터버턴 보이기
                    inputMode: "text",
                  },
                },
              ], // end of children
            },
            {
              dataField: "Nationwide",
              headerText: "전국",
              children: [
                {
                  dataField: "weekday",
                  headerText: "평일",
                  width: 120,
                  editRenderer: {
                    type: "InputEditRenderer",
                    showEditorBtnOver: true, // 마우스 오버 시 에디터버턴 보이기
                    inputMode: "text",
                  },
                },
                {
                  dataField: "weekend",
                  headerText: "주말",
                  width: 120,
                  editRenderer: {
                    type: "InputEditRenderer",
                    showEditorBtnOver: true, // 마우스 오버 시 에디터버턴 보이기
                    inputMode: "text",
                  },
                },
              ], // end of children
            },
            {
              dataField: "version",
              headerText: "버전",
              editRenderer: {
                type: "DropDownListRenderer",
                list: ["V1"],
              },
            },
        ],
        gridProps : {
            enableFilter : false,
            enableSorting : false,
            headerHeight : 60,
            headerHeights: [30, 30],
            rowHeight : 50,
            editingOnKeyDown : false,
            autoGridHeight : false,
            autoGridWidth : true,
            ignoreColumnMinWidth : true,
            softRemoveRowMode : false,
            // 행 번호 컬럼 활성화 속성입니다.
            showRowNumColumn : false,
            /*추가 옵션*/
            showStateColumn : false,
            editable : false,
            noDataMessage : "데이터가 존재하지 않습니다."
        }
    }),
    methods: {
        draw: function(){
            //$THO.show()
            $("#scenarioSummaryModal").modal('show');
        },
        clear: function(){
            // 초기화 영역
        },
        search: function(){
            // 검색영역
            //this.createGrid();
            this.gridData.push({
              createAt: "2022.10.12",
              baseYear: "2023",
              fromDate: "2023.01.1",
              toDate: "2023.12.31",
              genre: "드라마",
              division: "SD",
              prdCost: "200000",
              weekday: "1.80",
              weekend: "1.80",
              version: "V1",
            });

            this.gridData.push({
              createAt: "2022.10.12",
              baseYear: "2023",
              fromDate: "2023.01.1",
              toDate: "2023.12.31",
              genre: "드라마",
              division: "SD",
              prdCost: "200000",
              weekday: "1.80",
              weekend: "1.80",
              version: "V1",
            });

            this.gridData.push({
              createAt: "2022.10.12",
              baseYear: "2023",
              fromDate: "2023.01.1",
              toDate: "2023.12.31",
              genre: "드라마",
              division: "SD",
              prdCost: "200000",
              weekday: "1.80",
              weekend: "1.80",
              version: "V1",
            });


        },
        createGrid: function(){
            AUIGrid.destroy("#scenarioSummaryGrid");
            // grid 생성
            AUIGrid.create("#scenarioSummaryGrid", this.gridLayout, this.gridProps);

        }
    }
});
    // modal end

       // tab2 start
       let channelBaseGrid = "";
      let app3 = {
        el: "#app3",
        watch: {
          gridData: function () {
            AUIGrid.setGridData(channelBaseGrid, this.gridData);
          },
        },
        mounted() {
          channelBaseGrid = AUIGrid.destroy("#channelBaseGrid");
          channelBaseGrid = AUIGrid.create("#channelBaseGrid", this.gridLayout, this.gridProps);

          // 페이지 진입 시 기준년도 산출
          this.searchCommand.baseYear = new Date().getFullYear();
          // 기준년도 항목정의(과거:3년, 향후:5년)
          for (let idx = this.searchCommand.baseYear - 2; idx < this.searchCommand.baseYear + 5; idx += 1) {
            this.selectOptionItems.baseYear.push({ value: `${idx}`, text: `${idx}년` });
          }

          this.selectOptionItems.status.push({ value: "I", text: "진행중" });
          this.selectOptionItems.status.push({ value: "C", text: "확정" });

          this.search();
        },
        data: () => ({
          selectOptionItems: {
            baseYear: [{ value: "", text: "기준년도" }],
            genre: [{ value: "", text: "장르" }],
            status: [{ value: "", text: "채널그룹명" }],
          },
          searchCommand: {
            scenarioName: null,
            baseYear: "",
            genre: "",
            status: "",
          },
          gridData: [],
          gridLayout: [
            {
              dataField: "baseYear",
              headerText: "기준년도",
              editRenderer: {
                type: "DropDownListRenderer",
                list: ["2020년", "2021년", "2022년"],
              },
            },
            {
              dataField: "rating",
              headerText: "시청률",
              editRenderer: {
                type: "DropDownListRenderer",
                list: ["수도권"],
              },
            },
            {
              dataField: "scenarioName",
              headerText: "시나리오명",
              width:"40%",
              editRenderer: {
                type: "InputEditRenderer",
                showEditorBtnOver: true, // 마우스 오버 시 에디터버턴 보이기
                inputMode: "text",
              },
            },
            {
              dataField: "step",
              headerText: "단계",
              editRenderer: {
                type: "DropDownListRenderer",
                list: ["진행중", "확정"],
              },
            },
            {
              dataField: "returnRate",
              headerText: "재방비율(년/요일)",
              editRenderer: {
                type: "InputEditRenderer",
                showEditorBtnOver: true, // 마우스 오버 시 에디터버턴 보이기
                inputMode: "text",
              },
            },
            {
              headerText: "등록정보",
              renderer: {
                type: "TemplateRenderer",
              },
              labelFunction: function (rowIndex, columnIndex, value, headerText, item) {
                return `${item["departName"]} | ${item["writer"]} | ${item["createAt"]}`; //item.bdp_mod_id + "|" + item.bdp_mod_dtm;
              },
            },
           
          ],
          gridProps: {
            enableFilter: false,
            enableSorting: false,
            headerHeight: 60,
            headerHeights: [30, 30],
            rowHeight: 50,
            editingOnKeyDown: false,
            autoGridHeight: false,
            autoGridWidth: false,
            ignoreColumnMinWidth: true,
            softRemoveRowMode: false,
            // 행 번호 컬럼 활성화 속성입니다.
            showRowNumColumn: false,
            /*추가 옵션*/
            showStateColumn: false,
            editable: true,
            noDataMessage: "엑셀데이터를 붙여넣거나 행추가를 통해 데이터를 입력하세요.",
          },
        }),
        methods: {
          search: function () {
            console.log("search", this.searchCommand);
            this.setTestData();
          },
          createScenario: function () {
            this.$refs["refScenarioSummary"].draw();
          },
          edit: function (id) {
            console.log("준비중 edit", id);
          },
          version: function (id) {
            console.log("준비중 version", id);
          },
          copy: function (id) {
            console.log("준비중 copy", id);
          },
          remove: function (id) {
            console.log("준비중 remove", id);
          },
          done: function (id) {
            console.log("준비중 done", id);
          },
          setTestData: function () {
            this.gridData = [];
            this.gridData.push({
              writer: "홍길동",
              departName: "부서명",
              createAt: "2022.10.12",
              baseYear: "2023",
              rating: "수도권",
              scenarioName: "2023년 경영기반 시뮬레이션 1차",
              step: "확정",
              returnRate:"15.4%",
            });
          },
        },
      };

      $(function () {
        new Vue(app3);
        Vue.nextTick(function () {
          $(window).resize(function () {
            AUIGrid.resize("#channelBaseGrid");
          });
        });
        // Vue.component();
      });

      let cbDetailGrid = "";
      let app4 = {
        el: "#app4",
        watch: {
          gridData: function () {
            AUIGrid.setGridData(cbDetailGrid, this.gridData);
          },
        },
        mounted() {
          cbDetailGrid = AUIGrid.destroy("#cbDetailGrid");
          cbDetailGrid = AUIGrid.create("#cbDetailGrid", this.gridLayout, this.gridProps);

          // 페이지 진입 시 기준년도 산출
          this.searchCommand.baseYear = new Date().getFullYear();
          // 기준년도 항목정의(과거:3년, 향후:5년)
          for (let idx = this.searchCommand.baseYear - 2; idx < this.searchCommand.baseYear + 5; idx += 1) {
            this.selectOptionItems.baseYear.push({ value: `${idx}`, text: `${idx}년` });
          }

          this.selectOptionItems.status.push({ value: "I", text: "진행중" });
          this.selectOptionItems.status.push({ value: "C", text: "확정" });

          this.search();
        },
        data: () => ({
          selectOptionItems: {
            baseYear: [{ value: "", text: "기준년도" }],
            genre: [{ value: "", text: "장르" }],
            status: [{ value: "", text: "채널그룹명" }],
          },
          searchCommand: {
            scenarioName: null,
            baseYear: "",
            genre: "",
            status: "",
          },
          gridData: [],
          gridLayout: [
           
            {
              dataField: "baseYear",
              headerText: "기준년도",
              width: "7%",
              cellMerge: true,
              mergeRef: "division",
              mergePolicy: "restrict",
              editRenderer: {
                type: "DropDownListRenderer",
                list: ["2020년", "2021년", "2022년"],
              },
            },
           
            {
              dataField: "division",
              headerText: "구분",
              cellMerge: true,
              editRenderer: {
                type: "InputEditRenderer",
                showEditorBtnOver: true, // 마우스 오버 시 에디터버턴 보이기
                inputMode: "text",
              },
            },
            {
              dataField: "ep",
              headerText: "",
              editRenderer: {
                type: "InputEditRenderer",
                showEditorBtnOver: true, // 마우스 오버 시 에디터버턴 보이기
                inputMode: "text",
              },
            },
            {
              dataField: "january",
              headerText: "1월",
              editRenderer: {
                type: "InputEditRenderer",
                showEditorBtnOver: true, // 마우스 오버 시 에디터버턴 보이기
                inputMode: "text",
              },
            },
            {
              dataField: "february",
              headerText: "2월",
              editRenderer: {
                type: "InputEditRenderer",
                showEditorBtnOver: true, // 마우스 오버 시 에디터버턴 보이기
                inputMode: "text",
              },
            },
            {
              dataField: "march",
              headerText: "3월",
              editRenderer: {
                type: "InputEditRenderer",
                showEditorBtnOver: true, // 마우스 오버 시 에디터버턴 보이기
                inputMode: "text",
              },
            },
            {
              dataField: "april",
              headerText: "4월",
              editRenderer: {
                type: "InputEditRenderer",
                showEditorBtnOver: true, // 마우스 오버 시 에디터버턴 보이기
                inputMode: "text",
              },
            },
            {
              dataField: "may",
              headerText: "5월",
              editRenderer: {
                type: "InputEditRenderer",
                showEditorBtnOver: true, // 마우스 오버 시 에디터버턴 보이기
                inputMode: "text",
              },
            },
            {
              dataField: "june",
              headerText: "6월",
              editRenderer: {
                type: "InputEditRenderer",
                showEditorBtnOver: true, // 마우스 오버 시 에디터버턴 보이기
                inputMode: "text",
              },
            },
            {
              dataField: "july",
              headerText: "7월",
              editRenderer: {
                type: "InputEditRenderer",
                showEditorBtnOver: true, // 마우스 오버 시 에디터버턴 보이기
                inputMode: "text",
              },
            },
            {
              dataField: "august",
              headerText: "8월",
              editRenderer: {
                type: "InputEditRenderer",
                showEditorBtnOver: true, // 마우스 오버 시 에디터버턴 보이기
                inputMode: "text",
              },
            },
            {
              dataField: "september",
              headerText: "9월",
              editRenderer: {
                type: "InputEditRenderer",
                showEditorBtnOver: true, // 마우스 오버 시 에디터버턴 보이기
                inputMode: "text",
              },
            },
            {
              dataField: "october",
              headerText: "10월",
              editRenderer: {
                type: "InputEditRenderer",
                showEditorBtnOver: true, // 마우스 오버 시 에디터버턴 보이기
                inputMode: "text",
              },
            },
            {
              dataField: "november",
              headerText: "11월",
              editRenderer: {
                type: "InputEditRenderer",
                showEditorBtnOver: true, // 마우스 오버 시 에디터버턴 보이기
                inputMode: "text",
              },
            },
            {
              dataField: "december",
              headerText: "12월",
              editRenderer: {
                type: "InputEditRenderer",
                showEditorBtnOver: true, // 마우스 오버 시 에디터버턴 보이기
                inputMode: "text",
              },
            },
          ],
          gridProps: {
            enableCellMerge: true,
            enableFilter: false,
            enableSorting: false,
            headerHeight: 60,
            headerHeights: [30, 30],
            rowHeight: 50,
            editingOnKeyDown: false,
            autoGridHeight: false,
            autoGridWidth: false,
            ignoreColumnMinWidth: true,
            softRemoveRowMode: false,
            // 행 번호 컬럼 활성화 속성입니다.
            showRowNumColumn: false,
            /*추가 옵션*/
            showStateColumn: false,
            editable: true,
            noDataMessage: "엑셀데이터를 붙여넣거나 행추가를 통해 데이터를 입력하세요.",
          },
        }),
        methods: {
          search: function () {
            console.log("search", this.searchCommand);
            this.setTestData();
          },
          createScenario: function () {
            this.$refs["refScenarioSummary"].draw();
          },
          edit: function (id) {
            console.log("준비중 edit", id);
          },
          version: function (id) {
            console.log("준비중 version", id);
          },
          copy: function (id) {
            console.log("준비중 copy", id);
          },
          remove: function (id) {
            console.log("준비중 remove", id);
          },
          done: function (id) {
            console.log("준비중 done", id);
          },
          setTestData: function () {
            this.gridData = [];
            this.gridData.push({
              baseYear: "2023",
              division: "일평균",
              ep: "예상",
              january: "14.608",
              february: "15.990",
              march: "13.990",
              april: "12.990",
              may: "13.190",
              june: "13.290",
              july: "13.490",
              august: "15.690",
              september: "13.390",
              october: "13.290",
              november: "13.290",
              december: "13.290",
            });
            this.gridData.push({
              baseYear: "2023",
              division: "일평균",
              ep: "실적",
              january: "14.608",
              february: "15.990",
              march: "13.990",
              april: "12.990",
              may: "13.190",
              june: "13.290",
              july: "13.490",
              august: "15.690",
              september: "13.390",
              october: "13.290",
              november: "13.290",
              december: "13.290",
            });
            this.gridData.push({
              baseYear: "2023",
              division: "프라임",
              ep: "예상",
              january: "14.608",
              february: "15.990",
              march: "13.990",
              april: "12.990",
              may: "13.190",
              june: "13.290",
              july: "13.490",
              august: "15.690",
              september: "13.390",
              october: "13.290",
              november: "13.290",
              december: "13.290",
            });
            this.gridData.push({
              baseYear: "2023",
              division: "프라임",
              ep: "실적",
              january: "14.608",
              february: "15.990",
              march: "13.990",
              april: "12.990",
              may: "13.190",
              june: "13.290",
              july: "13.490",
              august: "15.690",
              september: "13.390",
              october: "13.290",
              november: "13.290",
              december: "13.290",
            });
          },
        },
      };

      $(function () {
        new Vue(app4);
        Vue.nextTick(function () {
          $(window).resize(function () {
            AUIGrid.resize("#cbDetailGrid");
          });
        });
        // Vue.component();
      });
      // tab2 end
   </script>
  </body>
</html>
